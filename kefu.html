<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>在线客服</title>
    <meta name="keywords" content="在线客服, 即时聊天, 客户支持" />
    <meta name="description" content="24小时为您提供专业在线客服服务" />
    
    <style type="text/css">
        /* 抖音风格加载动画 */
        .chaport-loader {
            position: fixed;
            bottom: 100px;
            right: 30px;
            z-index: 99999;
            background: linear-gradient(45deg, #ff3366, #ff6b6b, #ff9966);
            border-radius: 25px;
            padding: 15px 25px;
            color: white;
            font-family: 'Helvetica Neue', sans-serif;
            box-shadow: 0 4px 15px rgba(255,51,102,0.3);
            display: none;
            align-items: center;
            animation: float 3s ease-in-out infinite;
        }

        .loader-dots {
            display: inline-flex;
            margin-right: 12px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            margin: 0 3px;
            animation: bounce 1.4s infinite ease-in-out;
        }

        .dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 80%, 100% { 
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* 适配移动端 */
        @media (max-width: 768px) {
            .chaport-loader {
                bottom: 80px;
                right: 15px;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- 加载提示 -->
    <div class="chaport-loader" id="chaportLoader">
        <div class="loader-dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
        正在为您接入客服...
    </div>

<script type="text/javascript">
// 显示加载提示
function showLoader() {
    console.log('[DEBUG] 显示加载提示');
    const loader = document.getElementById('chaportLoader');
    loader.style.display = 'flex';
}

// 初始化 Chaport
(function(w,d,v3){
    showLoader(); 
    
    // 配置增强
    w.chaportConfig = {
        appId: '67db82c305681fb4e8b9bd25',
        autoOpen: true,
        minimizedStyle: 'popup',
        autoStart: true,  // 新增关键参数
        initialized: function() {
            console.log('[DEBUG] Chaport初始化完成');
            try {
                chaport.q('open');
                console.log('[DEBUG] 成功发送打开指令');
            } catch(e) {
                console.error('[ERROR] 打开聊天窗失败:', e);
            }
            document.getElementById('chaportLoader').style.display = 'none';
        }
    };

    if(w.chaport) {
        console.warn('[WARN] Chaport已存在，跳过重复加载');
        return;
    }
    
    v3=w.chaport={};
    v3._q=[];v3._l={};
    v3.q=function(){console.log('[DEBUG] Chaport队列操作:', arguments);v3._q.push(arguments)};
    
    var s=d.createElement('script');
    s.type='text/javascript';
    s.async=true;
    s.src='https://app.chaport.com/javascripts/insert.js';
    s.onerror = function() {
        console.error('[ERROR] Chaport脚本加载失败');
        document.getElementById('chaportLoader').style.display = 'none';
    };
    s.onload = function() {
        console.log('[DEBUG] Chaport SDK已加载');
        // 双保险打开机制
        setTimeout(() => {
            if (typeof chaport !== 'undefined') {
                chaport.q('open');
                console.log('[DEBUG] 通过onload回调打开');
            }
        }, 1000);
    };
    
    var ss=d.getElementsByTagName('script')[0];
    ss.parentNode.insertBefore(s,ss);
})(window, document);

// 三保险定时器
setTimeout(() => {
    if (typeof chaport !== 'undefined') {
        chaport.q('open');
        console.log('[DEBUG] 通过全局定时器打开');
    } else {
        console.error('[ERROR] Chaport对象未定义');
    }
}, 1000);
</script>
</body>
</html>
